_ = require 'underscore'

flags = (process.env.NOG_TEST_FLAGS ? '').split(',')

# Keep `describe` and `it` modifiers in sync with `nog-test`.
if _.isFunction(describe ? null) and _.isFunction(it ? null)
  describe.ifRealAws = it.ifRealAws = (name, args...) ->
    if 'useRealAws' in flags
      @(name + ' [exec since useRealAws in NOG_TEST_FLAGS]', args...)
    else
      @skip(name + ' [skip since useRealAws not in NOG_TEST_FLAGS]', args...)

  # `describe.unlessSkipFlaky` and `it...` could be added when needed.

exports.flags =
  useRealAws: ->
    if 'useRealAws' in flags
      console.log '[exec since useRealAws in NOG_TEST_FLAGS]'
      true
    else
      console.log '[skip since useRealAws not in NOG_TEST_FLAGS]'
      false

  skipFlaky: ->
    if 'skipFlaky' in flags
      console.log "[skip since skipFlaky in NOG_TEST_FLAGS]"
      true
    else
      console.log "[exec since skipFlaky not in NOG_TEST_FLAGS]"
      false
